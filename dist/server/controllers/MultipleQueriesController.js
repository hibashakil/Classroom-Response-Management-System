"use strict";
var CourseBusiness = require("./../app/business/CourseBusiness");
var AttendanceBusiness = require("./../app/business/AttendanceBusiness");
var passport = require('passport');
var MultipleQueriesController = (function () {
    function MultipleQueriesController() {
    }
    MultipleQueriesController.prototype.selCourseAttendance = function (req, res) {
        try {
            var _id = req.params._id;
            var attendanceBusiness = new AttendanceBusiness();
            var courseBusiness = new CourseBusiness();
            var attendance = { "name": "null", "1": "A", "2": "A", "3": "A", "4": "A",
                "5": "A", "6": "A", "7": "A", "8": "A", "9": "A", "10": "A", "11": "A",
                "12": "A", "13": "A", "14": "A", "15": "A", "16": "A", "17": "A",
                "18": "A", "19": "A", "20": "A", "21": "A", "22": "A", "23": "A",
                "24": "A", "25": "A", "26": "A", "27": "A", "28": "A", "29": "A", "30": "A" };
            var send = [];
            attendanceBusiness.selCourseAttendance(_id, function (error, result1) {
                if (error) {
                    console.log(error);
                }
                else {
                    courseBusiness.allStudentsEnrolled(_id, function (error, result2) {
                        if (error) {
                            console.log(error);
                        }
                        else {
                            for (var i = 0; i < result2[0].studentsEnrolled.length; i++) {
                                attendance.name = result2[0].studentsEnrolled[i];
                                var l = send.push(attendance);
                            }
                            //to change a json key
                            // for (var i = 0; i < send.length; i++) {
                            //     var obj = send[i];
                            //     console.log(obj);
                            //     for (var key in obj) {
                            //         if (key === "one") {
                            //             obj[key] = "P";
                            //         }
                            // }
                            for (var i = 0; i < result1.length; i++) {
                                for (var j = 0; j < result1[i].studentsPresent.length; j++) {
                                    var name = result1[i].studentsPresent[j];
                                    for (var k = 0; k < send.length; k++) {
                                        if (send[k].name === name) {
                                            var sess = result1[i].session.toString();
                                            var obj = send[k];
                                            for (var key in obj) {
                                                if (key === sess) {
                                                    obj[key] = "P";
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                            console.log(send);
                            res.send(send);
                        }
                    });
                }
            });
        }
        catch (e) {
            console.log(e);
            res.send({ "error": "error in your request" });
        }
    };
    return MultipleQueriesController;
}());
module.exports = MultipleQueriesController;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbnRyb2xsZXJzL011bHRpcGxlUXVlcmllc0NvbnRyb2xsZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUNBLElBQU8sY0FBYyxXQUFXLGtDQUFrQyxDQUFDLENBQUM7QUFDcEUsSUFBTyxrQkFBa0IsV0FBVyxzQ0FBc0MsQ0FBQyxDQUFDO0FBRzVFLElBQUksUUFBUSxHQUFHLE9BQU8sQ0FBQyxVQUFVLENBQUMsQ0FBQztBQUduQztJQUFBO0lBNkRBLENBQUM7SUE1REcsdURBQW1CLEdBQW5CLFVBQW9CLEdBQW9CLEVBQUUsR0FBcUI7UUFDM0QsSUFBSSxDQUFDO1lBQ0QsSUFBSSxHQUFHLEdBQVcsR0FBRyxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUM7WUFDakMsSUFBSSxrQkFBa0IsR0FBRyxJQUFJLGtCQUFrQixFQUFFLENBQUM7WUFDbEQsSUFBSSxjQUFjLEdBQUcsSUFBSSxjQUFjLEVBQUUsQ0FBQztZQUMxQyxJQUFJLFVBQVUsR0FBSSxFQUFDLE1BQU0sRUFBRyxNQUFNLEVBQUUsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsRUFBRyxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUc7Z0JBQzNFLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsRUFBRSxJQUFJLEVBQUUsR0FBRyxFQUFFLElBQUksRUFBRSxHQUFHO2dCQUNyRSxJQUFJLEVBQUUsR0FBRyxFQUFFLElBQUksRUFBRSxHQUFHLEVBQUUsSUFBSSxFQUFFLEdBQUcsRUFBRSxJQUFJLEVBQUUsR0FBRyxFQUFFLElBQUksRUFBRSxHQUFHLEVBQUUsSUFBSSxFQUFFLEdBQUc7Z0JBQ2hFLElBQUksRUFBRSxHQUFHLEVBQUUsSUFBSSxFQUFFLEdBQUcsRUFBRSxJQUFJLEVBQUUsR0FBRyxFQUFFLElBQUksRUFBRSxHQUFHLEVB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Qzs0QkFDbEIsR0FBRyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQzt3QkFDbkIsQ0FBQztvQkFDTCxDQUFDLENBQUMsQ0FBQztnQkFDUCxDQUFDO1lBQ0wsQ0FBQyxDQUFDLENBQUM7UUFDSCxDQUFFO1FBQUEsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUNULE9BQU8sQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDZixHQUFHLENBQUMsSUFBSSxDQUFDLEVBQUMsT0FBTyxFQUFFLHVCQUF1QixFQUFDLENBQUMsQ0FBQztRQUNqRCxDQUFDO0lBQ0wsQ0FBQztJQUNMLGdDQUFDO0FBQUQsQ0E3REEsQUE2REMsSUFBQTtBQUNELGlCQUFTLHlCQUF5QixDQUFDIiwiZmlsZSI6ImNvbnRyb2xsZXJzL011bHRpcGxlUXVlcmllc0NvbnRyb2xsZXIuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgZXhwcmVzcyA9IHJlcXVpcmUoXCJleHByZXNzXCIpO1xyXG5pbXBvcnQgQ291cnNlQnVzaW5lc3MgPSByZXF1aXJlKFwiLi8uLi9hcHAvYnVzaW5lc3MvQ291cnNlQnVzaW5lc3NcIik7XHJcbmltcG9ydCBBdHRlbmRhbmNlQnVzaW5lc3MgPSByZXF1aXJlKFwiLi8uLi9hcHAvYnVzaW5lc3MvQXR0ZW5kYW5jZUJ1c2luZXNzXCIpO1xyXG5pbXBvcnQgSUNvdXJzZU1vZGVsID0gcmVxdWlyZShcIi4vLi4vYXBwL21vZGVsL2ludGVyZmFjZXMvQ291cnNlTW9kZWxcIik7XHJcbmltcG9ydCBJQXR0ZW5kYW5jZU1vZGVsID0gcmVxdWlyZShcIi4vLi4vYXBwL21vZGVsL2ludGVyZmFjZXMvQXR0ZW5kYW5jZU1vZGVsXCIpO1xyXG52YXIgcGFzc3BvcnQgPSByZXF1aXJlKCdwYXNzcG9ydCcpO1xyXG5cclxuXHJcbmNsYXNzIE11bHRpcGxlUXVlcmllc0NvbnRyb2xsZXIge1xyXG4gICAgc2VsQ291cnNlQXR0ZW5kYW5jZShyZXE6IGV4cHJlc3MuUmVxdWVzdCwgcmVzOiBleHByZXNzLlJlc3BvbnNlKSB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgdmFyIF9pZDogbnVtYmVyID0gcmVxLnBhcmFtcy5faWQ7XHJcbiAgICAgICAgICAgIHZhciBhdHRlbmRhbmNlQnVzaW5lc3MgPSBuZXcgQXR0ZW5kYW5jZUJ1c2luZXNzKCk7XHJcbiAgICAgICAgICAgIHZhciBjb3Vyc2VCdXNpbmVzcyA9IG5ldyBDb3Vyc2VCdXNpbmVzcygpO1xyXG4gICAgICAgICAgICB2YXIgYXR0ZW5kYW5jZSA9ICB7XCJuYW1lXCIgOiBcIm51bGxcIiwgXCIxXCI6IFwiQVwiLCBcIjJcIjogXCJBXCIsIFwiM1wiIDogXCJBXCIsIFwiNFwiOiBcIkFcIixcclxuICAgICAgICAgICAgXCI1XCI6IFwiQVwiLCBcIjZcIjogXCJBXCIsIFwiN1wiOiBcIkFcIiwgXCI4XCI6IFwiQVwiLCBcIjlcIjogXCJBXCIsIFwiMTBcIjogXCJBXCIsIFwiMTFcIjogXCJBXCIsXHJcbiAgICAgICAgICAgICBcIjEyXCI6IFwiQVwiLCBcIjEzXCI6IFwiQVwiLCBcIjE0XCI6IFwiQVwiLCBcIjE1XCI6IFwiQVwiLCBcIjE2XCI6IFwiQVwiLCBcIjE3XCI6IFwiQVwiLFxyXG4gICAgICAgICAgICAgXCIxOFwiOiBcIkFcIiwgXCIxOVwiOiBcIkFcIiwgXCIyMFwiOiBcIkFcIiwgXCIyMVwiOiBcIkFcIiwgXCIyMlwiOiBcIkFcIiwgXCIyM1wiOiBcIkFcIixcclxuICAgICAgICAgICAgICBcIjI0XCI6IFwiQVwiLCBcIjI1XCI6IFwiQVwiLCBcIjI2XCI6IFwiQVwiLCBcIjI3XCI6IFwiQVwiLCBcIjI4XCI6IFwiQVwiLCBcIjI5XCI6IFwiQVwiLCBcIjMwXCI6IFwiQVwiIH07XHJcbiAgICAgICAgICAgdmFyIHNlbmQgPSBbXTtcclxuICAgICAgICAgICAgYXR0ZW5kYW5jZUJ1c2luZXNzLnNlbENvdXJzZUF0dGVuZGFuY2UoX2lkLCAoZXJyb3IsIHJlc3VsdDEpID0+IHtcclxuICAgICAgICAgICAgICAgIGlmIChlcnJvcikge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY291cnNlQnVzaW5lc3MuYWxsU3R1ZGVudHNFbnJvbGxlZChfaWQsIChlcnJvciwgcmVzdWx0MikgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXJyb3IpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcmVzdWx0MlswXS5zdHVkZW50c0Vucm9sbGVkLmxlbmd0aCA7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0dGVuZGFuY2UubmFtZSA9IHJlc3VsdDJbMF0uc3R1ZGVudHNFbnJvbGxlZFtpXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbCA9IHNlbmQucHVzaChhdHRlbmRhbmNlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vdG8gY2hhbmdlIGEganNvbiBrZXlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGZvciAodmFyIGkgPSAwOyBpIDwgc2VuZC5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgIHZhciBvYmogPSBzZW5kW2ldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgIGNvbnNvbGUubG9nKG9iaik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAgICAgZm9yICh2YXIga2V5IGluIG9iaikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgICBpZiAoa2V5ID09PSBcIm9uZVwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICBvYmpba2V5XSA9IFwiUFwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCByZXN1bHQxLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCByZXN1bHQxW2ldLnN0dWRlbnRzUHJlc2VudC5sZW5ndGg7IGorKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbmFtZSA9IHJlc3VsdDFbaV0uc3R1ZGVudHNQcmVzZW50W2pdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBrID0gMDsgayA8IHNlbmQubGVuZ3RoIDsgaysrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2VuZFtrXS5uYW1lID09PSBuYW1lKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNlc3MgPSByZXN1bHQxW2ldLnNlc3Npb24udG9TdHJpbmcoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgb2JqID0gc2VuZFtrXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gb2JqKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChrZXkgPT09IHNlc3MpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9ialtrZXldID0gXCJQXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coc2VuZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcy5zZW5kKHNlbmQpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhlKTtcclxuICAgICAgICAgICAgcmVzLnNlbmQoe1wiZXJyb3JcIjogXCJlcnJvciBpbiB5b3VyIHJlcXVlc3RcIn0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5leHBvcnQgPSBNdWx0aXBsZVF1ZXJpZXNDb250cm9sbGVyOyJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
